<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">





  
  
  <link rel="canonical" href="http://yoursite.com/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Hexo</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/19/springnote1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="皇叔">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/04/19/springnote1/" class="post-title-link" itemprop="url">Spring笔记01</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-04-19 21:07:05" itemprop="dateCreated datePublished" datetime="2019-04-19T21:07:05+08:00">2019-04-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-20 18:08:51" itemprop="dateModified" datetime="2019-04-20T18:08:51+08:00">2019-04-20</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="spring笔记（一）——程序的耦合和解耦"><a href="#spring笔记（一）——程序的耦合和解耦" class="headerlink" title="spring笔记（一）——程序的耦合和解耦"></a><strong>spring笔记（一）——程序的耦合和解耦</strong></h1><p>耦合：程序之间的依赖关系<br>第一步：通过反射来创建对象，而避免使用new关键字<br>第二部：通过读取配置文件来获取要创建的对象全限定类名  </p>
<h2 id="工厂模式解耦"><a href="#工厂模式解耦" class="headerlink" title="工厂模式解耦"></a>工厂模式解耦</h2><p>一个创建Bean对象的工厂<br>Bean：可重用组件<br>JavaBean！=实体类：实体类是Bean的一部分。JavaBean是使用java语言编写的可重用组件。<br>工厂就是创建serveice和dao对象的<br>第一：需要一个配置文件来配置service和dao。<br>　　　　配置的内容：全限定类名=唯一标识。（key=value）<br>第二：通过读取配置文件中配置的内容，反射创建对象。<br>配置文件可以是xml和properties<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Properties props;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//实例化对象</span></span><br><span class="line">            props = <span class="keyword">new</span> Properties();</span><br><span class="line">            <span class="comment">//获取properties文件的流对象</span></span><br><span class="line">            InputStream in = BeanFactory.class.getClassLoader().getResourceAsStream(<span class="string">"bean.properties"</span>);</span><br><span class="line">            props.load(in);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ExceptionInInitializerError(<span class="string">"初始化properties失败"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据bean的名称获取bean对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> beanName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String beanName)</span></span>&#123;<span class="comment">//此处使用静态方法。因为无法在静态类中引用非静态对象</span></span><br><span class="line">        Object bean = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            String beanPath = props.getProperty(beanName);</span><br><span class="line">            bean = Class.forName(beanPath).newInstance();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h2><p>控制反转（IOC）<br>降低程序间的依赖</p>
<h3 id="使用spring中的IOC解决程序耦合"><a href="#使用spring中的IOC解决程序耦合" class="headerlink" title="使用spring中的IOC解决程序耦合"></a>使用spring中的IOC解决程序耦合</h3><p>　　导入beanfactory的工程，delete掉factory。在resources下新建xml文件，该文件可自由命名。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--吧对象的创建交给spring管理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span> = <span class="string">"accountDao"</span> <span class="attr">class</span> = <span class="string">"com.itheima.dao.impl.AccountDaoImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>获取spring的IOC核心容器，并根据id获取对象。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取spring的IOC核心容器，并根据id获取对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//IAccountService as =new AccountServiceImpl();</span></span><br><span class="line">        <span class="comment">//1.获取核心容器对象</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"bean.xml"</span>);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">            applicationcontext三个常用实现类</span></span><br><span class="line"><span class="comment">     *      CkassPathXmlApplicationContext:加载类路径下的配置文件，要求配置文件必须在类路径下</span></span><br><span class="line"><span class="comment">     *      FileSystemXml：加载磁盘任一路经下的配置文件</span></span><br><span class="line"><span class="comment">     *      AnnotationConfig：读取注解创建容器</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">//2.根据id获取bean对象</span></span><br><span class="line">        IAccountService as =(IAccountService)ac.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">        IAccountDao adao =ac.getBean(<span class="string">"accountDao"</span>,IAccountDao.class);</span><br><span class="line"></span><br><span class="line">        System.out.println(as);</span><br><span class="line">        System.out.println(adao);</span><br><span class="line">        </span><br><span class="line"><span class="comment">//        as.saveAccount();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>核心容器的两个接口引发出的问题</p>
<ul>
<li>ApplicationContext：  适用场景（单例对象创建）<br>   它在构建核心容器时，创建对象采取的思想是采用立即加载的方式。也就是说，只要一读取完配置文件马上就创建配置文件中配置的对象。</li>
<li>Beanfactory：    适用场景（多例对象）<br>  创建对象时采取的策略是延迟加载的方式。什么时候根据id获取对象，什么时候才真正地创建对象。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//---------------BeanFactory----------------</span></span><br><span class="line">        Resource resource = <span class="keyword">new</span> ClassPathResource(<span class="string">"bean.xml"</span>);</span><br><span class="line">        BeanFactory factory = <span class="keyword">new</span> XmlBeanFactory(resource);</span><br><span class="line"></span><br><span class="line">        IAccountService as =(IAccountService)factory.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">        System.out.println(as);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>spring框架可以从配置上的不同选择不同的对象创建模式。实例开发中更多的是采用ApplicationContext接口创建对象。</p>
<h2 id="spring对bean对象的管理细节"><a href="#spring对bean对象的管理细节" class="headerlink" title="spring对bean对象的管理细节"></a>spring对bean对象的管理细节</h2><h3 id="创建bean的三种方式"><a href="#创建bean的三种方式" class="headerlink" title="创建bean的三种方式"></a>创建bean的三种方式</h3><ul>
<li>使用默认构造函数创建<br>　　在spring配置文件中使用bean标签，配以id和class属性之后，且没有其他属性和标签时。采用的就是默认构造函数创建bean对象，此时如果类中没有默认构造函数，则对象无法创建。并在xml文件中就会报错。</li>
<li><p>使用普通工厂中的方法创建对象（使用某个类中的方法创建对象，并存入spring容器）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"instanceFactory"</span> <span class="attr">class</span>=<span class="string">"com.itheima.factory.InstanceFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">factory-bean</span>=<span class="string">"instanceFactory"</span> <span class="attr">factory-method</span>=<span class="string">"getAccountService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用工厂的静态方法创建对象（使用某个类中的静态方法创建对象，并存入spring容器）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"instanceFactory"</span> <span class="attr">class</span>=<span class="string">"com.itheima.factory.InstanceFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.factory.StaticFactory"</span> <span class="attr">factory-method</span>=<span class="string">"getAccountService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.factory;</span><br><span class="line"><span class="keyword">import</span> com.itheima.service.IAccountService;</span><br><span class="line"><span class="keyword">import</span> com.itheima.service.impl.AccountServiceImpl;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  IAccountService <span class="title">getAccountService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> AccountServiceImpl();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="bean的作用范围"><a href="#bean的作用范围" class="headerlink" title="bean的作用范围"></a>bean的作用范围</h3><p>bean标签的scope属性用于用于指定bean的作用范围，取值：常用单例或者多例 </p>
<ul>
<li>singleton：单例（默认值）</li>
<li>prototype：多例</li>
<li>request：作用于web应用的请求范围</li>
<li>session：作用于web应用的会话范围</li>
<li>global-session：作用于集群环境的会话范围（全局会话范围），当不是集群环境时，它就是session</li>
</ul>
<h3 id="bean的生命周期"><a href="#bean的生命周期" class="headerlink" title="bean的生命周期"></a>bean的生命周期</h3><ul>
<li>单例对象：<pre><code>出生：容器创建时  
活着：容器存在  
死亡：容器销毁  
总结：单例对象的生命周期与容器相同
</code></pre><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">scope</span>=<span class="string">"singleton"</span> <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"destroy"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模拟保存账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccountServiceImpl</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"对象创建了"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"service中的saveAccount方法执行了"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"对象初始化"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"对象销毁"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ClassPathXmlApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"bean.xml"</span>);</span><br><span class="line"></span><br><span class="line">        IAccountService as =(IAccountService)ac.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">        as.saveAccount();</span><br><span class="line">        ac.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>多例对象：<pre><code>出生：使用对象时spring框架创建  
活着：对象在使用过程中  
死亡：当对象长时间不用，且没有别的对象引用时，由Java的辣鸡回收器回收
</code></pre><h2 id="spring的依赖注入"><a href="#spring的依赖注入" class="headerlink" title="spring的依赖注入"></a>spring的依赖注入</h2>依赖注入：dependency injection。<br>IOC的作用： 降低程序间的耦合。<br>依赖关系的管理：交给spring的维护。<br>在当前类需要用到其他类的对象，有spring为我们提供，我们只需要在配置文件中说明依赖关系的维护：就称之为依赖注入。  </li>
<li>能够注入的类型：三类<br>　　基本类型和String<br>　　其他bean类型（在配置文件中或者注解配置过的bean）<br>　　复杂类型  </li>
<li>注入的方式：<br><strong>使用构造函数注入</strong><br>使用的标签：constructor-org<br>标签出现的位置：bean标签的内部<br>标签中的属性:<br>　　type：用于指定注入的数据的数据类型，该数据类型也是构造函数中某个或某些参数的类型<br>　　index:用于指定要注入的数据给构造函数中指定索引位置的参数赋值，索引的位置从0开始<br>　　name：用于指定给构造函数中指定名称的参数赋值（常用）<br>　　value：用于给基本类型和string类型的数据<br>　　ref：引用关联的bean对象，用于指定其他的bean类型数据。（在spring的IOC核心容器中出现过的bean对象）<br>优势：在获取bean对象时，注入数据是必须的操作，否则对象无法创建成功。<br>弊端：改变了bean对象的实例化方式，使我们在创建对象时如果用不到这些数据也必须提供。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模拟保存账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//如果是经常变化的数据，并不适用于注入的方式</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccountServiceImpl</span><span class="params">(String name,Integer age,Date birthday)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">        <span class="keyword">this</span>.birthday=birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"service中的saveAccount方法执行了"</span>+name+<span class="string">","</span>+age+<span class="string">","</span>+birthday);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"test"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"birthday"</span> <span class="attr">ref</span>=<span class="string">"now"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--配置一个日期对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"now"</span> <span class="attr">class</span>=<span class="string">"java.util.Date"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>使用set方法提供(较上面的方法更加常用)</strong><br>　　涉及的标签；property<br>　　出现的位置：bean标签的内部<br>　　标签的属性：<br>　　　　name:用于指定注入时所调用的set方法名称<br>　　　　value:同上<br>　　　　ref:同上<br>　　优势：创建对象时没有明确的限制，可直接使用默认构造函数<br>　　弊端：若有某个成员必须有值，则获取对象时有可能set方法没有执行  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl2</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模拟保存账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果是经常变化的数据，并不适用于注入的方式</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"service中的saveAccount方法执行了"</span>+name+<span class="string">","</span>+age+<span class="string">","</span>+birthday);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService2"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl2"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"test"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"21"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"birthday"</span> <span class="attr">ref</span>=<span class="string">"now"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>使用注解提供</strong><br>此处不做介绍<br><strong>复杂类型/集合类型的注入</strong><br>于给List结构集合注入的标签：list,array,set<br>用于给map结构集合注入的标签：map，property<br>　　<strong>结构相同，标签可以互换</strong><br>常用set方法进行注入。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl3</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String[] myStrs;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; myList;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; mySet;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; myMap;</span><br><span class="line">    <span class="keyword">private</span> Properties myPops;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyStrs</span><span class="params">(String[] myStrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myStrs = myStrs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyList</span><span class="params">(List&lt;String&gt; myList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myList = myList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMySet</span><span class="params">(Set&lt;String&gt; mySet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mySet = mySet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyMap</span><span class="params">(Map&lt;String, String&gt; myMap)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myMap = myMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyPops</span><span class="params">(Properties myPops)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myPops = myPops;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(Arrays.toString(myStrs));</span><br><span class="line">        System.out.println(myList);</span><br><span class="line">        System.out.println(mySet);</span><br><span class="line">        System.out.println(myMap);</span><br><span class="line">        System.out.println(myPops);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService3"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myStrs"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myList"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mySet"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myMap"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"testA"</span> <span class="attr">value</span>=<span class="string">"aaa"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"testB"</span> &gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                        bbb</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myPops"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"testC"</span> &gt;</span>ccc<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"testD"</span> &gt;</span>ddd<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/03/Oracle Install in CentOS7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="皇叔">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/04/03/Oracle Install in CentOS7/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-04-03 14:14:24" itemprop="dateCreated datePublished" datetime="2019-04-03T14:14:24+08:00">2019-04-03</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-19 15:41:22" itemprop="dateModified" datetime="2019-04-19T15:41:22+08:00">2019-04-19</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>@<a href="再次入魂——小白在CentOS7.6环境下部署Oracle11g服务器并使用Windows客户端连接">TOC</a></p>
<h1 id="1-学习几个基本Linux终端指令"><a href="#1-学习几个基本Linux终端指令" class="headerlink" title="1.学习几个基本Linux终端指令"></a>1.学习几个基本Linux终端指令</h1><p>　　由于Linux和Windows的软件安装方式有很大的不同，所以基本上都是需要在终端上敲命令行代码实现的。<br>　　一、cd（change directory）切换目录<br>　　<code>$cd　　　　　直接回到根目录</code><br>　　<code>$cd ..　　　　回到上级目录</code><br>　　<code>$cd 路径名　　切换至该路径</code><br>　　二、ls　查看文件或目录<br>　　<code>$ls　　　　　查看当前目录的文件与目录</code><br>　　<code>$cd 路径名　　查看该路径下的文件与目录</code><br>　　ls命令常用于检查目录下的文件及目录。这样我们就不用费力地去找文件管理器下的文件而是可以直接在终端中查看。当我们不确定自己创建的目录是否成功时可以轻松地使用ls查看。<br>　　三、su 和 sudo<br>　　有些时候一些指令需要我们拥有管理员权限方能执行，这个时候这两个指令就非常重要。<br>　　<code>su</code><br>　　进入root模式。su命令执行后，你需要在终端输入root密码，在终端中，密码是不显示的，输完直接敲回车即可。这是系统root用户，拥有很高的权限。值得注意的是，Ubuntu刚安装好是没有激活root的，需要我们手动激活。这时我们需要sudo指令。<br>　　<code>sudo</code><br>　　在指令的前面加上sudo 即可在管理员模式下执行指令。当然，密码还是要输的，这里输的密码是你的系统用户密码（开机密码）而不是root密码。<br>　　<code>sudo passwd root</code><br>　　执行该指令即可设定root密码。<br>　　四、vim 文档编辑<br>　　这个指令我们会在环境变量及配置文档的修改编辑中遇到。系统没有的话可在root模式中通过指令安装<br>　　<code>yum -y install vim</code><br>　　安装好之后使用指令<code>vim xxx</code>进入xxx文件。键盘敲击’i’即可进入insert模式。编辑完毕后按’esc’,在键盘上输入 <strong>‘:wq’</strong> 保存并退出。记住一定要加’冒号‘。不想保存的话用’:q’。</p>
<h1 id="2-安装Java并配置环境变量"><a href="#2-安装Java并配置环境变量" class="headerlink" title="2.安装Java并配置环境变量"></a>2.安装Java并配置环境变量</h1><p>　　由于Oracle是基于Java环境的数据库，所以必须要配置Java方可运行。CentOS如果你装了图形界面的话应该是自带Java的。但是没有安装jdk，如果你不需要安装sql developer(一款可视化Oracle操作工具)。那么这一步可以略过不看。<br>　　一、卸载系统自带JDK<br>　　依次执行如下指令<br>　　<code>rpm -qa | grep java</code><br>　　命令说明：<br>　　rpm 　　管理套件<br>　　-qa 　　使用询问模式，查询所有套件<br>　　grep　　查找文件里符合条件的字符串<br>　　java 　　查找包含java字符串的文件<br>　　将除了.noarch文件的Java文件全删了。进入root用户，输入<br>　<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rpm -e --nodeps java-1.7.0-openjdk-1.7.0.111-2.6.7.8.el7.x86_64</span><br><span class="line">rpm -e --nodeps java-1.8.0-openjdk-1.8.0.102-4.b14.el7.x86_64</span><br><span class="line">rpm -e --nodeps java-1.8.0-openjdk-headless-1.8.0.102-4.b14.el7.x86_64</span><br><span class="line">rpm -e --nodeps java-1.7.0-openjdk-headless-1.7.0.111-2.6.7.8.el7.x86_64</span><br></pre></td></tr></table></figure></p>
<p>　　命令介绍：<br>　　-e                      删除指定套件<br>　　–nodeps        不验证套件档的相互关联性<br>　　检查一下是否删除成功<br>　　<code>java -version</code><br>　　若未找到Java命令代表删除成功，若没有成功可用<code>yum -y remove</code>指令删一下。<br>　　二、安装JDK<br>　　从各种网站上找到你所需要的JDK版本并下载，这个看你自己，我下的是从官网上找的1.8。下载完毕打开安装目录，在目录中打开终端。将文件复制到/usr/java目录中并解压。<br>　　<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">　　su</span><br><span class="line">　　cp 安装包文件名 /usr/java</span><br><span class="line">　　tar -zxvf 文件名</span><br><span class="line">　　rm -f 安装包文件名</span><br></pre></td></tr></table></figure></p>
<p>　　三、JDK环境变量的配置<br>　　通过指令<br>　　<code>sudo vim /etc/profile</code><br>　　打开profile文件，此文件存储Linux中的各种环境变量，敲击’i’在文件末尾加入以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_144</span><br><span class="line"></span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/jre/lib/rt.jar:$&#123;JRE_HOME&#125;/lib/dt.jar:$&#123;JAVA_HOME&#125;/lib/tools.jar</span><br><span class="line"></span><br><span class="line">export PATH=$PATH:$&#123;JAVA_HOME&#125;/bin:</span><br></pre></td></tr></table></figure></p>
<p>如何保存并退出在上一章节已经有提到，以后章节不再赘述。保存完毕后我们先要更新一下系统参数<code>source /etc/profile</code>在终端测试一下是否安装成功。依次输入指令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo %JAVA_HOME   </span><br><span class="line">java -version</span><br></pre></td></tr></table></figure></p>
<p>若出现我们添加进profile文件中的路径以及正确的java版本号则安装成功。若未出现，可能你需要检查一下profile文件或者java安装包。</p>
<h1 id="3-安装前的准备工作"><a href="#3-安装前的准备工作" class="headerlink" title="3.安装前的准备工作"></a>3.安装前的准备工作</h1><p>在进行各种依赖的下载还有乱七八糟的事之前，我们先把Oracle的安装包下载任务开始起来，这样就不需要多等一段时间了。Oracle11g的安装包在官网很容易找到，注意一定要将两个压缩包全部下载下来。最好还能定点下载到一个<strong>指定的目录</strong>里。本人就是将其下载至主文件夹下的<strong>Oracle</strong>文件夹下。这样方便后续的操作。<br>注意：此处所用的指令都需要root老大哥才能完成。出错的时候先看看是不是权限的问题。</p>
<h2 id="一、用户组创建并更改OS系统标志"><a href="#一、用户组创建并更改OS系统标志" class="headerlink" title="一、用户组创建并更改OS系统标志"></a>一、用户组创建并更改OS系统标志</h2><p>运行下列指令通过命令行使用root模式创建用户和用户组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line">groupadd oinstall</span><br><span class="line">groupadd dba</span><br><span class="line">useradd -g oinstall -g dba -m oracle</span><br></pre></td></tr></table></figure></p>
<p>查询用户组是否成功加入到用户组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groups oracle</span><br></pre></td></tr></table></figure></p>
<p>设置oracle用户登录密码<br><code>passwd oracle</code><br>由于Oracle默认只支持redhat，不支持Ubuntu、centos等其他Linux系统，所以将系统标志修改成RedHat-7<br><code>vim /etc/redhat-release</code><br>内容修改为<code>redhat-7</code>。<br>关闭防火墙。<br><code>systemctl stop firewalld</code><br>其实可以仅仅开放你所需要的端口。笔者在这里使用的是9999端口，Oracle默认的是1521端口。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=9999/tcp --permanent  </span><br><span class="line"></span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure></p>
<p>关闭selinux（重启后生效）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/selinux/config</span><br><span class="line">//修改SELINUX=disabled并去掉#</span><br></pre></td></tr></table></figure></p>
<p>重启并进入oracle用户<br><code>reboot</code><br>注意：在生产环境下不可关闭防火墙和selinux。</p>
<h2 id="二、创建Oracle数据库安装目录"><a href="#二、创建Oracle数据库安装目录" class="headerlink" title="二、创建Oracle数据库安装目录"></a>二、创建Oracle数据库安装目录</h2><p>创建目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/oracle</span><br><span class="line">mkdir -p /data/oraInventory</span><br><span class="line">mkdir -p /data/database</span><br></pre></td></tr></table></figure></p>
<p>注意：这里使用的都是绝对路径，即在前面有个‘/’。<br>接下来将这些文件夹的使用权限都赋给我们刚刚创建的oracle用户。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /data</span><br><span class="line">ls</span><br><span class="line">chown -R oracle:oinstall /data/oracle</span><br><span class="line">chown -R oracle:oinstall /data/oraInventory</span><br><span class="line">chown -R oracle:oinstall /data/database</span><br></pre></td></tr></table></figure></p>
<h2 id="三-、依赖包的安装"><a href="#三-、依赖包的安装" class="headerlink" title="三 、依赖包的安装"></a>三 、依赖包的安装</h2><p>　　Linux不同于Windows，这些东西都需要我们自己手动去安装。要装的东西多的要死，这里用yum指令进行批量安装，要稍等一会儿。<br><code>yum install binutils-2.* compat-libstdc++-33* elfutils-libelf-0.* elfutils-libelf-devel-* gcc-4.* gcc-c++-4.* glibc-2.* glibc-common-2.* glibc-devel-2.* glibc-headers-2.* ksh-2* libaio-0.* libaio-devel-0.* libgcc-4.* libstdc++-4.* libstdc++-devel-4.* make-3.* sysstat-7.* unixODBC-2.* unixODBC-devel-2.* pdksh*</code> </p>
<h2 id="四、配置系统内核参数"><a href="#四、配置系统内核参数" class="headerlink" title="四、配置系统内核参数"></a>四、配置系统内核参数</h2><p>　　这里我们可以直接开两个终端来配，查一个配一个比较方便。<br>　　新建一个终端键入指令<code>sudo vim /etc/sysctl.conf</code>。<br>　　原终端按下列指令依次查出对应参数的值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/sbin/sysctl -a | grep sem</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep file-max</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep aio-max</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep ip_local_port_range</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep rmem_default</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep rmem_max</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep wmem_default</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep wmem_max</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep shmall</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep shmmax</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep shmmni</span><br></pre></td></tr></table></figure></p>
<p>　　再将值填入对应的参数中并添加至新终端的’sysctl.conf’的末尾并保存退出。确保填入的值尽量是默认的内核参数，但是不能少于下列示例。　　<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.icmp_echo_ignore_broadcasts = 1</span><br><span class="line">net.ipv4.conf.all.rp_filter = 1</span><br><span class="line">fs.file-max = 6815744 #设置最大打开文件数</span><br><span class="line">fs.aio-max-nr = 1048576</span><br><span class="line">kernel.shmall = 2097152 #共享内存的总量，8G内存设置：2097152*4k/1024/1024</span><br><span class="line">kernel.shmmax = 2147483648 #最大共享内存的段大小</span><br><span class="line">kernel.shmmni = 4096 #整个系统共享内存端的最大数</span><br><span class="line">kernel.sem = 250 32000 100 128</span><br><span class="line">net.core.rmem_default = 262144</span><br><span class="line">net.core.rmem_max= 4194304</span><br><span class="line">net.core.wmem_default= 262144</span><br><span class="line">net.core.wmem_max= 1048576</span><br><span class="line">net.ipv4.ip_local_port_range = 1000 65500 #可使用的IPv4端口范围</span><br></pre></td></tr></table></figure></p>
<p>更新内核参数<code>sysctl -p</code>。  </p>
<h2 id="五、配置Oracle环境变量"><a href="#五、配置Oracle环境变量" class="headerlink" title="五、配置Oracle环境变量"></a>五、配置Oracle环境变量</h2><p>　　现在我们要配置Oracle的环境变量。<code>sudo vim /home/oracle/.bash_profile</code>  。将下列内容添加至文件后面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">export ORACLE_BASE=/data/oracle</span><br><span class="line"></span><br><span class="line">export ORACLE_HOME=$ORACLE_BASE/product/11.2.0/dbhome_1</span><br><span class="line"></span><br><span class="line">export ORACLE_SID=orcl</span><br><span class="line"></span><br><span class="line">export ORACLE_UNQNAME=orcl</span><br><span class="line"></span><br><span class="line">export ORACLE_TERM=xterm</span><br><span class="line"></span><br><span class="line">export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib #添加系统环境变量</span><br><span class="line"></span><br><span class="line">export LANG=C #防止安装过程出现乱码</span><br><span class="line"></span><br><span class="line">export NLS_LANG=AMERICAN_AMERICA.ZHS16GBK  #设置Oracle客户端字符集，必须与Oracle安装时设置的字符集保持一致</span><br><span class="line"></span><br><span class="line">export PATH=$&#123;PATH&#125;:$&#123;ORACLE_HOME&#125;/bin/:/usr/sbin</span><br></pre></td></tr></table></figure></p>
<p>保存并退出后更新一下环境变量<code>source /home/oracle/.bash_profile</code>。</p>
<h2 id="三、正式安装"><a href="#三、正式安装" class="headerlink" title="三、正式安装"></a>三、正式安装</h2><p>　　将安装包解压至指定目录。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">unzip linux.x64_11gR2_database_1of2.zip -d /data/database</span><br><span class="line"></span><br><span class="line">unzip linux.x64_11gR2_database_2of2.zip -d /data/database</span><br><span class="line"></span><br><span class="line">chown -R oracle:oinstall /data</span><br><span class="line"></span><br><span class="line">cd /data/database/database</span><br><span class="line"></span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line">./runInstaller</span><br></pre></td></tr></table></figure></p>
<p>这样我们就进入了安装Oracle的图形界面了。<br>注意：这样做有的情况会出现提示条只出现白条的问题，这样我们就无法进行下一步了，甚至连退出都够呛。笔者就出现过这种情况。这个我们参考<a href="https://blog.csdn.net/ykyorky/article/details/79259424?utm_source=blogxgwz6中的解决方案。使用指令" target="_blank" rel="noopener">https://blog.csdn.net/ykyorky/article/details/79259424?utm_source=blogxgwz6中的解决方案。使用指令</a><br><code>./runInstall -jreLoc JDK安装路径</code><br>进行安装<br>-&gt;注：以下除了密码之外未提及支之处全部选择默认值即可。密码这个自行决定。<br>-&gt;在Configure Security Updates中去掉“I wish”，邮箱也不用填直接下一步。弹出警告框也不用管。下面同理不多赘述。<br>-&gt;在Installation option中选择install database software only<br>-&gt;在Grid Installation中选择single instance database installation<br>-&gt;在Product Languages上可以添加简体中文（simplified-chinese）<br>-&gt;在Select Database Edition选择企业版（enterprise）<br>-&gt;在Typical Installation中路径选择刚才安装包解压的目录，笔者的目标目录在上面已经写好，不多赘述。输入密码并确认。点击下一步，报错不管它。<br>-&gt;第十二步，选择上面的character sets进入界面 选择Use Unicode(AL32UTF8),然后选择上面Sample Schemas,进入界面后将选项打钩<br>-&gt;在Prerequis like Checks中勾选 ignore All。因为我们之前已经安装好所有的依赖了，所以只要忽略即可。这里最好还要新建一个终端跑一下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp/CVU_11.2.0.1.0_用户名</span><br><span class="line"></span><br><span class="line">sudo ./runfixup.sh</span><br></pre></td></tr></table></figure></p>
<p>-&gt;点击Finish开始安装。<br>-&gt;安装时会报错,新建终端敲一下指令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line"></span><br><span class="line">yum -y install glibc-static</span><br><span class="line"></span><br><span class="line">vim /data/oracle/product/11.2.0/db_1/ctx/lib/ins_ctx.mk</span><br></pre></td></tr></table></figure></p>
<p>将<br><code>ctxhx: $(CTXHXOBJ)
       $(LINK_CTXHX) $(CTXHXOBJ) $(INSO_LINK)</code><br>修改为：<br><code>ctxhx: $(CTXHXOBJ)
       -static $(LINK_CTXHX) $(CTXHXOBJ) $(INSO_LINK) /usr/lib64/libc.a</code><br>接着再改一下ins_emagent.mk文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /data/oracle/product/11.2.0/dbhome_1/sysman/lib</span><br><span class="line"></span><br><span class="line">yum -y install gedit</span><br><span class="line"></span><br><span class="line">gedit ins_emagent.mk</span><br></pre></td></tr></table></figure></p>
<p>在打开的文件中找到<code>$(SYSMANBIN)emdctl</code>，将冒号后的值改为<code>$(MK_EMAGENT_NMECTL -lnnz11)</code>。在gedit中可以使用Ctrl+f进行查找。修改完毕后保存退出。<br>点击retry。<br>如果出现很多权限问题可自行百度，笔者碰到过一个坑但是解决方法忘了，大致就是改一下配置文件或者授予文件夹权限之类的。<br>-&gt;后面一直ok就行。</p>
<h2 id="四、配置监听并创建数据库实例测试"><a href="#四、配置监听并创建数据库实例测试" class="headerlink" title="四、配置监听并创建数据库实例测试"></a>四、配置监听并创建数据库实例测试</h2><p>首先检查一下参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $ORACLE_BASE</span><br><span class="line"></span><br><span class="line">echo $ORACLE_HOME</span><br><span class="line"></span><br><span class="line">echo $PATH</span><br></pre></td></tr></table></figure></p>
<p>如果不对的话你需要看一下之前的环境变量设置。仔细查看你的路径名，包括用户名是不是自己的。参数对的话就可以启动监听了。  </p>
<h2 id="1）配置监听"><a href="#1）配置监听" class="headerlink" title="1）配置监听"></a>1）配置监听</h2><p>我们使用命令<code>netca</code>进行监听的设定。<br>注意：如果你所使用的端口号在步骤3.1中没有打开，那么是无法创建监听的。这里面基本没什么不懂的，看得懂英文就行。只不过要注意在选择协议的时候选择TCP。出错的话可能是环境变量的问题或者是文件夹权限的问题，问题都不是很大。</p>
<h2 id="2）创建一个Oracle数据库实例"><a href="#2）创建一个Oracle数据库实例" class="headerlink" title="2）创建一个Oracle数据库实例"></a>2）创建一个Oracle数据库实例</h2><p>如果你看了别的教程在安装阶段就已经创建了数据库实例，那么可以跳过本步骤。这里说的是没有创建数据库实例的情况。执行<code>dbca</code>命令进入图形界面。点击next即可进入下一步。<img src="https://img-blog.csdnimg.cn/20190408233533957.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNjcwMzA0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>选择“create a database”<br><img src="https://img-blog.csdnimg.cn/20190408233707292.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNjcwMzA0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>选择“custom dataase”<br><img src="https://img-blog.csdnimg.cn/20190408234023515.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNjcwMzA0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>填入之前在环境变量文件中写的sid，如果上面你是直接复制的话那么填入<code>orcl</code>即可，想换的话也行，不过要把环境变量中的一起换掉。<br><img src="https://img-blog.csdnimg.cn/20190408234033157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNjcwMzA0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>后面笔者懒得叙述了，反正基本都能成功，觉得讲得不够详细可以看我最后一章参考的资料。出错按照错误代码百度相应的解决方案。笔者遇到的错误比较奇葩。提示的是我共享内存空间不足了，于是我找了很多解决方案，最简单的还是直接reboot重启（重启大法好啊）。</p>
<h2 id="3）测试"><a href="#3）测试" class="headerlink" title="3）测试"></a>3）测试</h2><p>新开一个终端，写入下列命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlplus /nolog</span><br><span class="line"></span><br><span class="line">conn / as sysdba</span><br></pre></td></tr></table></figure></p>
<p>这样你就可以用sys超级管理员用户连接我们刚刚创建的数据库实例orcl了。<br>可以在SQL里做个小测试<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure></p>
<p>成功了那你的Oracle服务器就部署成功了。</p>
<h1 id="4-使用Windows客户机连接服务器上的Oracle"><a href="#4-使用Windows客户机连接服务器上的Oracle" class="headerlink" title="4.使用Windows客户机连接服务器上的Oracle"></a>4.使用Windows客户机连接服务器上的Oracle</h1><h2 id="一、创建用户"><a href="#一、创建用户" class="headerlink" title="一、创建用户"></a>一、创建用户</h2><p>直至上面测试做完为止，我们的数据库用户还是只有sys这一个超级用户。我们做项目不可能只有一个用户的，这个时候我们要创建给客户用的用户。在SQL中写以下指令。(注意：SQL指令是要加分号的)。还要注意把括号内说明段删掉。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> njust2048(用户名)<span class="keyword">identified</span> <span class="keyword">by</span> <span class="keyword">admin</span>(密码);</span><br><span class="line"></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">resource</span>,<span class="keyword">connect</span>,dba <span class="keyword">to</span> cs2048;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> user_sys_privs;</span><br></pre></td></tr></table></figure></p>
<p>对于普通用户：授予connect, resource权限。<br>对于DBA管理用户：授予connect，resource, dba权限。<br>DBA: 拥有全部特权，是系统最高权限，只有DBA才可以创建数据库结构。sysdba角色之外权限最大的角色。<br>RESOURCE:拥有Resource权限的用户只可以创建实体，不可以创建数据库结构。<br>CONNECT:拥有Connect权限的用户只可以登录Oracle，不可以创建实体，不可以创建数据库结构。</p>
<h2 id="二、使用创建的用户连接数据库"><a href="#二、使用创建的用户连接数据库" class="headerlink" title="二、使用创建的用户连接数据库"></a>二、使用创建的用户连接数据库</h2><p>这里有两种方案可以选择。</p>
<h3 id="1）使用Oracle-SQL-developor"><a href="#1）使用Oracle-SQL-developor" class="headerlink" title="1）使用Oracle SQL developor"></a>1）使用Oracle SQL developor</h3><p>这种图形界面可以分为一个大类。有兴趣或者要求的读者可以寻找其他的软件。使用Oracle SQL developer的话必须要安装jdk才行。从Oracle官网上下载安装包（对应你客户机的jdk版本）并安装。进入界面。  点击加号新建连接。连接名自定义，用户名和密码使用我们刚刚创建好的用户和密码。主机名填写服务器域名。sid可以在服务器使用<code>select instance_name from v$instance;</code>查询。端口号为默认的1521。点击测试可以测试连接可靠性。测试成功后连接即可。</p>
<h3 id="2）使用控制台连接数据库"><a href="#2）使用控制台连接数据库" class="headerlink" title="2）使用控制台连接数据库"></a>2）使用控制台连接数据库</h3><p>在Windows下打开cmd或者power shell。执行以下命令。<br><code>sqlplus cs2048/2048@192.168.1.113:1521/orcl</code><br>这样你就可以连接至服务器的数据库。注意，这里的参数顺序分别是：<br>cs2048（用户名）；2048（密码）；192.168.1.113（服务器IP）；orcl（服务名）</p>
<h1 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h1><p><a href="https://www.cnblogs.com/muhehe/p/7816808.html" target="_blank" rel="noopener">https://www.cnblogs.com/muhehe/p/7816808.html</a><br><a href="https://blog.csdn.net/ykyorky/article/details/79259424?utm_source=blogxgwz6" target="_blank" rel="noopener">https://blog.csdn.net/ykyorky/article/details/79259424?utm_source=blogxgwz6</a><br><a href="https://www.cnblogs.com/buxingzhelyd/p/7865194.html" target="_blank" rel="noopener">https://www.cnblogs.com/buxingzhelyd/p/7865194.html</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/09/Oracle Install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="皇叔">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/09/Oracle Install/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-03-09 12:25:20" itemprop="dateCreated datePublished" datetime="2019-03-09T12:25:20+08:00">2019-03-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-02 22:23:05" itemprop="dateModified" datetime="2019-04-02T22:23:05+08:00">2019-04-02</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一发入魂——小白在Ubuntu16环境下部署Oracle服务器并使用Windows客户端连接"><a href="#一发入魂——小白在Ubuntu16环境下部署Oracle服务器并使用Windows客户端连接" class="headerlink" title="一发入魂——小白在Ubuntu16环境下部署Oracle服务器并使用Windows客户端连接"></a><strong>一发入魂——小白在Ubuntu16环境下部署Oracle服务器并使用Windows客户端连接</strong></h1><h1 id="1-学习几个基本Linux终端指令"><a href="#1-学习几个基本Linux终端指令" class="headerlink" title="1.学习几个基本Linux终端指令"></a>1.学习几个基本Linux终端指令</h1><p>　　由于Linux和Windows的软件安装方式有很大的不同，所以基本上都是需要在终端上敲命令行代码实现的。<br>　　一、cd（change directory）切换目录<br>　　<code>$cd　　　　　直接回到根目录</code><br>　　<code>$cd ..　　　　回到上级目录</code><br>　　<code>$cd 路径名　　切换至该路径</code><br>　　二、ls　查看文件或目录<br>　　<code>$ls　　　　　查看当前目录的文件与目录</code><br>　　<code>$cd 路径名　　查看该路径下的文件与目录</code><br>　　ls命令常用于检查目录下的文件及目录。这样我们就不用费力地去找文件管理器下的文件而是可以直接在终端中查看。当我们不确定自己创建的目录是否成功时可以轻松地使用ls查看。<br>　　三、su 和 sudo<br>　　有些时候一些指令需要我们拥有管理员权限方能执行，这个时候这两个指令就非常重要。<br>　　<code>su</code><br>　　进入root模式。su命令执行后，你需要在终端输入root密码，在终端中，密码是不显示的，输完直接敲回车即可。这是系统root用户，拥有很高的权限。值得注意的是，Ubuntu刚安装好是没有激活root的，需要我们手动激活。这时我们需要sudo指令。<br>　　<code>sudo</code><br>　　在指令的前面加上sudo 即可在管理员模式下执行指令。当然，密码还是要输的，这里输的密码是你的系统用户密码（开机密码）而不是root密码。<br>　　<code>sudo passwd root</code><br>　　执行该指令即可设定root密码。<br>　　四、vim 文档编辑<br>　　这个指令我们会在环境变量及配置文档的修改编辑中遇到。系统没有的话可以通过指令安装<br>　　<code>sudo apt-get install vim</code><br>　　安装好之后使用指令<code>sudo vim xxx</code>进入xxx文件。键盘敲击’i’即可进入insert模式。编辑完毕后按’esc’,在键盘上输入 <strong>‘:wq’</strong> 保存并退出。记住一定要加’冒号‘。不想保存的话用’:q’。</p>
<h1 id="2-安装JDK并配置环境变量"><a href="#2-安装JDK并配置环境变量" class="headerlink" title="2.安装JDK并配置环境变量"></a>2.安装JDK并配置环境变量</h1><p>　　由于Oracle是基于Java环境的数据库，所以必须要配置JDK方可运行。我们首先打开终端。<br>　　一、JDK安装<br>　　依次执行如下指令<br>　　<code>sudo apt-get update</code><br>　　<code>sudo apt-get install openjdk-8-jdk</code><br>　　这里安装的是JDK8，大家可以根据实际情况选用所需的JDK版本。<br>　　二、JDK环境变量的配置<br>　　通过指令<br>　　<code>sudo vim /etc/profile</code><br>　　打开profile文件，此文件存储Linux中的各种环境变量，后面的Oracle环境变量也将在此编辑。敲击’i’在文件末尾加入以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64</span><br><span class="line"></span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</span><br><span class="line"></span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib</span><br><span class="line"></span><br><span class="line">export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH</span><br></pre></td></tr></table></figure></p>
<p>如何保存并退出在上一章节已经有提到，以后章节不再赘述。保存完毕后我们先要更新一下系统参数<code>source /etc/profile</code>在终端测试一下是否安装成功。依次输入指令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo %JAVA_HOME   </span><br><span class="line">java -version</span><br></pre></td></tr></table></figure></p>
<p>若出现我们添加进profile文件中的路径以及正确的java版本号则安装成功。若未出现，可能你需要检查一下profile文件或者java安装包。</p>
<h1 id="3-Oracle安装"><a href="#3-Oracle安装" class="headerlink" title="3.Oracle安装"></a>3.Oracle安装</h1><p>在进行各种依赖的下载还有乱七八糟的事之前，我们先把Oracle的安装包下载任务开始起来，这样就不需要多等一段时间了。Oracle11g的安装包在官网很容易找到，注意一定要将两个压缩包全部下载下来。最好还能定点下载到一个<strong>指定的目录</strong>里。本人就是将其下载至主文件夹下的<strong>Oracle</strong>文件夹下。这样方便后续的操作。  </p>
<h2 id="一、依赖包的安装"><a href="#一、依赖包的安装" class="headerlink" title="一、依赖包的安装"></a>一、依赖包的安装</h2><p>　　Linux不同于Windows，这些东西都需要我们自己手动去安装。要装的东西多的要死，笔者参考了一下网上的代码，来自Linux社区的rogear将其整合了一下，通过一句指令安装所有的依赖包。 因为包太多了，所以安装起来要稍微等一会儿。<br><code>sudo apt-get -y install automake autotools-dev binutils bzip2 elfutils expat gawk gcc gcc-multilib g++-multilib lib32ncurses5 lib32z1 ksh less lib32z1 libaio1 libaio-dev libc6-dev libc6-dev-i386 libc6-i386 libelf-dev libltdl-dev libxm4 libodbcinstq4-1 libodbcinstq4-1:i386 libpth-dev libpthread-stubs0-dev libstdc++5 make openssh-server rlwrap rpm sysstat unixodbc unixodbc-dev unzip x11-utils zlibc</code><br>　　笔者亲测没有问题，要问为什么，因为我也是小白！有两个依赖是32位的，需要换源安装。也不是太麻烦，依次执行以下指令即可。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line"></span><br><span class="line">cd /etc/apt/sources.list.d</span><br><span class="line"></span><br><span class="line">echo &quot;deb http://old-releases.ubuntu.com/ubuntu/ raring main restricted universe multiverse&quot; &gt; ia32-libs-raring.list</span><br><span class="line"></span><br><span class="line">apt update</span><br><span class="line"></span><br><span class="line">apt-get -y install lesstif2 lesstif2-dev</span><br><span class="line"></span><br><span class="line">rm -rf ia32-libs-raring.list</span><br><span class="line"></span><br><span class="line">apt update</span><br><span class="line"></span><br><span class="line">exit</span><br></pre></td></tr></table></figure></p>
<p>　　如果出现什么问题，那就将前两步调换一下位置。Linux中的依赖包有的是相互依赖的，笔者小白一枚也没搞清楚。  </p>
<h2 id="二、配置环境"><a href="#二、配置环境" class="headerlink" title="二、配置环境"></a>二、配置环境</h2><p>　　这里我们可以直接开两个终端来配，查一个配一个比较方便。<br>　　新建一个终端键入指令<code>sudo vim /etc/sysctl.conf</code>。<br>　　原终端按下列指令依次查出对应参数的值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/sbin/sysctl -a | grep sem</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep file-max</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep aio-max</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep ip_local_port_range</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep rmem_default</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep rmem_max</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep wmem_default</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep wmem_max</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep shmall</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep shmmax</span><br><span class="line"></span><br><span class="line">/sbin/sysctl -a | grep shmmni</span><br></pre></td></tr></table></figure></p>
<p>　　再将值填入对应的参数中并添加至新终端的’sysctl.conf’的末尾并保存退出。　　<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">fs.aio-max-nr = 65536</span><br><span class="line"></span><br><span class="line">fs.file-max = 242293</span><br><span class="line"></span><br><span class="line">kernel.shmall = 18446744073692774399</span><br><span class="line"></span><br><span class="line">kernel.shmmax = 18446744073692774399</span><br><span class="line"></span><br><span class="line">kernel.shmmni = 4096</span><br><span class="line"></span><br><span class="line">kernel.sem = 32000 1024000000 500 32000</span><br><span class="line"></span><br><span class="line">net.ipv4.ip_local_port_range = 32768 60999</span><br><span class="line"></span><br><span class="line">net.core.rmem_default = 212992</span><br><span class="line"></span><br><span class="line">net.core.rmem_max = 212992</span><br><span class="line"></span><br><span class="line">net.core.wmem_default = 212992</span><br><span class="line"></span><br><span class="line">net.core.wmem_max = 212992</span><br></pre></td></tr></table></figure></p>
<p>更新内核参数<code>sysctl -p</code>。<br>添加用户的内核限制<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd </span><br><span class="line">cd /etc/security</span><br><span class="line">sudo vim limits.conf</span><br></pre></td></tr></table></figure></p>
<p>添加以下内容至文件末尾（’end of file’后）。用户名就是你登录Ubuntu的用户名，比如我的是njust。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">用户名 soft nproc 2047</span><br><span class="line"></span><br><span class="line">用户名 hard nproc 16384</span><br><span class="line"></span><br><span class="line">用户名 soft nofile 1024</span><br><span class="line"></span><br><span class="line">用户名 hard nofile 65536</span><br><span class="line"></span><br><span class="line">用户名 soft stack 10240</span><br></pre></td></tr></table></figure></p>
<p>　　现在我们要配置Oracle的环境变量。<code>sudo vim /etc/profile</code>  。将下列内容添加至文件后面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">export ORACLE_BASE=你的Oracle路径,笔者是/home/njust/Oracle</span><br><span class="line"></span><br><span class="line">export ORACLE_HOME=$ORACLE_BASE/product/11.2.0/dbhome_1</span><br><span class="line"></span><br><span class="line">export ORACLE_SID=orcl</span><br><span class="line"></span><br><span class="line">export ORACLE_UNQNAME=orcl</span><br><span class="line"></span><br><span class="line">export NLS_LANG=.AL32UTF8</span><br><span class="line"></span><br><span class="line">export PATH=$&#123;PATH&#125;:$&#123;ORACLE_HOME&#125;/bin/:$ORACLE_HOME/lib64</span><br></pre></td></tr></table></figure></p>
<p>保存并退出后更新一下环境变量<code>source /etc/profile</code>。<br>　　最好检查一下/etc/pam.d/login，增加以下行（有了就不用增加了）： session required pam_limits.so。<br>　　检查/etc/pam.d/su，没有以下行就自己加上： session required pam_limits.so。<br>　　由于Oracle默认不支持Ubuntu，所以我们需要通过以下命令欺骗一下Oracle安装程序。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /usr/lib64</span><br><span class="line"></span><br><span class="line">sudo ln -s /etc /etc/rc.d</span><br><span class="line"></span><br><span class="line">sudo ln -s /lib/x86_64-linux-gnu/libgcc_s.so.1 /lib64/</span><br><span class="line"></span><br><span class="line">sudo ln -s /usr/bin/awk /bin/awk</span><br><span class="line"></span><br><span class="line">sudo ln -s /usr/bin/basename /bin/basename</span><br><span class="line"></span><br><span class="line">sudo ln -s /usr/bin/rpm /bin/rpm</span><br><span class="line"></span><br><span class="line">sudo ln -s /usr/lib/x86_64-linux-gnu/libc_nonshared.a /usr/lib64/</span><br><span class="line"></span><br><span class="line">sudo ln -s /usr/lib/x86_64-linux-gnu/libpthread_nonshared.a /usr/lib64/</span><br><span class="line"></span><br><span class="line">sudo ln -s /usr/lib/x86_64-linux-gnu/libstdc++.so.6 /lib64/</span><br><span class="line"></span><br><span class="line">sudo ln -s /usr/lib/x86_64-linux-gnu/libstdc++.so.6 /usr/lib64/</span><br><span class="line"></span><br><span class="line">su</span><br><span class="line"></span><br><span class="line">echo &apos;Red Hat Linux release 5&apos; &gt; /etc/RedHat-release</span><br><span class="line"></span><br><span class="line">exit</span><br></pre></td></tr></table></figure></p>
<h2 id="三、正式安装"><a href="#三、正式安装" class="headerlink" title="三、正式安装"></a>三、正式安装</h2><p>　　将安装包解压至指定目录，本人是直接在/Home/Oracle下解压的。解压后会生成一个database目录。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd /Oracle</span><br><span class="line"></span><br><span class="line">unzip linux.x64_11gR2_database_1of2.zip</span><br><span class="line"></span><br><span class="line">unzip linux.x64_11gR2_database_2of2.zip</span><br><span class="line"></span><br><span class="line">cd database/</span><br><span class="line"></span><br><span class="line">./runInstaller</span><br></pre></td></tr></table></figure></p>
<p>这样我们就进入了安装Oracle的图形界面了。如果发现安装界面乱码可以执行命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export NLS_LANG=AMERICAN_AMERICA.UTF8</span><br><span class="line"></span><br><span class="line">export LC_ALL=C</span><br></pre></td></tr></table></figure></p>
<p>-&gt;注：以下除了密码之外未提及支之处全部选择默认值即可。密码这个自行决定。<br>-&gt;在Configure Security Updates中去掉“I wish”，邮箱也不用填直接下一步。弹出警告框也不用管。下面同理不多赘述。<br>-&gt;在System Class中选择Server Class。<br>-&gt;选择Advanced install<br>-&gt;在Product Languages上可以添加简体中文（simplified-chinese）<br>-&gt;在Typical Installation中路径选择刚才安装包解压的目录，笔者的目录就是/Home/Oracle。输入管理员密码并确认。点击下一步，报错不管它。<br>-&gt;第十二步，选择上面的character sets进入界面 选择Use Unicode(AL32UTF8),然后选择上面Sample Schemas,进入界面后将选项打钩<br>-&gt;在Prerequis like Checks中勾选 ignore All。因为我们之前已经安装好所有的依赖了，所以只要忽略即可。这里最好还要新建一个终端跑一下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp/CVU_11.2.0.1.0_用户名</span><br><span class="line"></span><br><span class="line">sudo ./runfixup.sh</span><br></pre></td></tr></table></figure></p>
<p>-&gt;点击Finish开始安装。<br>-&gt;安装至68%时会报错,第一个错误（有关ins_ctx.mk）直接continue。从第二个错开始我们就要干活儿了。<br>-&gt;第二个错误，我们需要新建终端执行以下指令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /Oracle/product/11.2.0/dbhome_1/sysman/lib</span><br><span class="line"></span><br><span class="line">sudo apt install gedit</span><br><span class="line"></span><br><span class="line">gedit ins_emagent.mk</span><br></pre></td></tr></table></figure></p>
<p>在打开的文件中找到<code>$(SYSMANBIN)emdctl</code>，将冒号后的值改为<code>$(MK_EMAGENT_NMECTL -lnnz11)</code>。在gedit中可以使用Ctrl+f进行查找。修改完毕后保存退出。点击retry。<br>-&gt;我们发现又会报错，没关系，依次执行以下指令即可。执行完retry即可。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo sed -i &apos;s/^\(TNSLSNR_LINKLINE.*\$(TNSLSNR_OFILES)\) \(\$(LINKTTLIBS)\)/\1 -Wl,--no-as-needed \2/g&apos; /home/rogear/tools/oracle11g/product/11.2.0/dbhome_1/network/lib/env_network.mk</span><br><span class="line"></span><br><span class="line">sudo sed -i &apos;s/^\(ORACLE_LINKLINE.*\$(ORACLE_LINKER)\) \(\$(PL_FLAGS)\)/\1 -Wl,--no-as-needed \2/g&apos; /home/rogear/tools/oracle11g/product/11.2.0/dbhome_1/rdbms/lib/env_rdbms.mk</span><br><span class="line"></span><br><span class="line">sudo sed -i &apos;s/^\(\$LD \$LD_RUNTIME\) \(\$LD_OPT\)/\1 -Wl,--no-as-needed \2/g&apos; /home/rogear/tools/oracle11g/product/11.2.0/dbhome_1/bin/genorasdksh</span><br><span class="line"></span><br><span class="line">sudo sed -i &apos;s/^\(\s*\)\(\$(OCRLIBS_DEFAULT)\)/\1 -Wl,--no-as-needed \2/g&apos; /home/rogear/tools/oracle11g/product/11.2.0/dbhome_1/srvm/lib/ins_srvm.mk</span><br></pre></td></tr></table></figure></p>
<p>-&gt;后面一直ok就行。</p>
<h2 id="四、测试"><a href="#四、测试" class="headerlink" title="四、测试"></a>四、测试</h2><p>首先检查一下参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $ORACLE_BASE</span><br><span class="line"></span><br><span class="line">echo $ORACLE_HOME</span><br><span class="line"></span><br><span class="line">echo $PATH</span><br></pre></td></tr></table></figure></p>
<p>如果不对的话你需要看一下之前的环境变量设置。仔细查看你的路径名，包括用户名是不是自己的。参数对的话就可以启动监听了。<br><code>lsnrctl start</code><br>如果不行的话，基本上还是环境变量的问题。启动服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlplus /nolog</span><br><span class="line"></span><br><span class="line">conn / as sysdba</span><br><span class="line"></span><br><span class="line">startup</span><br></pre></td></tr></table></figure></p>
<p>可以在SQL里做个小测试<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure></p>
<p>成功了那你的Oracle服务器就部署成功了。</p>
<h1 id="4-使用Windows客户机连接服务器上的Oracle"><a href="#4-使用Windows客户机连接服务器上的Oracle" class="headerlink" title="4.使用Windows客户机连接服务器上的Oracle"></a>4.使用Windows客户机连接服务器上的Oracle</h1><h2 id="一、创建用户"><a href="#一、创建用户" class="headerlink" title="一、创建用户"></a>一、创建用户</h2><p>直至上面测试做完为止，我们的数据库用户还是只有sys这一个超级用户。我们做项目不可能只有一个用户的，这个时候我们要创建给客户用的用户。在SQL中写以下指令。(注意：SQL指令是要加分号的)。还要注意把括号内说明段删掉。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> njust2048(用户名)<span class="keyword">identified</span> <span class="keyword">by</span> <span class="keyword">admin</span>(密码);</span><br><span class="line"></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">resource</span>,<span class="keyword">connect</span>,dba <span class="keyword">to</span> cs2048;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> user_sys_privs;</span><br></pre></td></tr></table></figure></p>
<p>对于普通用户：授予connect, resource权限。<br>对于DBA管理用户：授予connect，resource, dba权限。<br>DBA: 拥有全部特权，是系统最高权限，只有DBA才可以创建数据库结构。sysdba角色之外权限最大的角色。<br>RESOURCE:拥有Resource权限的用户只可以创建实体，不可以创建数据库结构。<br>CONNECT:拥有Connect权限的用户只可以登录Oracle，不可以创建实体，不可以创建数据库结构。</p>
<h2 id="二、使用创建的用户连接数据库"><a href="#二、使用创建的用户连接数据库" class="headerlink" title="二、使用创建的用户连接数据库"></a>二、使用创建的用户连接数据库</h2><p>这里有两种方案可以选择。</p>
<h3 id="1）使用Oracle-SQL-developor"><a href="#1）使用Oracle-SQL-developor" class="headerlink" title="1）使用Oracle SQL developor"></a>1）使用Oracle SQL developor</h3><p>这种图形界面可以分为一个大类。有兴趣或者要求的读者可以寻找其他的软件。<br>从Oracle官网上下载安装包（对应你客户机的jdk版本）并安装。进入界面。  点击加号新建连接。连接名自定义，用户名和密码使用我们刚刚创建好的用户和密码。主机名填写服务器域名。sid可以在服务器使用<code>select instance_name from v$instance;</code>查询。端口号为默认的1521。点击测试可以测试连接可靠性。测试成功后连接即可。</p>
<h3 id="2）使用控制台连接数据库"><a href="#2）使用控制台连接数据库" class="headerlink" title="2）使用控制台连接数据库"></a>2）使用控制台连接数据库</h3><p>在Windows下打开cmd或者power shell。执行以下命令。<br><code>sqlplus sys/password@192.168.110.30/orcl as sysdba</code>  </p>
<h1 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h1><p><a href="https://blog.csdn.net/weixin_40461281/article/details/79784429" target="_blank" rel="noopener">https://blog.csdn.net/weixin_40461281/article/details/79784429</a><br><a href="https://www.linuxidc.com/Linux/2017-12/149797.htm" target="_blank" rel="noopener">https://www.linuxidc.com/Linux/2017-12/149797.htm</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">皇叔</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags">
                    
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">皇叔</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.0"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
